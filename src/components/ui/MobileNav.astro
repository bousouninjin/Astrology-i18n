---
import type { Lang } from '@/utils/i18n';
import { t } from '@/utils/translations';
import { NAV_ITEMS } from '@/utils/navItems';
import { getRelativeLocaleUrl } from 'astro:i18n';

interface Props {
  lang?: Lang;
  class?: string;
}
const { lang, class: className } = Astro.props as Props;
const resolvedLang = ((Astro.currentLocale as Lang | undefined) ??
  (lang as Lang | undefined) ??
  'zh') as Lang;
---

<div class={`lg:hidden hidden ${className ?? ''}`.trim()} data-mobile-panel>
  <div class="border-t border-base-300 bg-base-100">
    <div class="container py-3">
      <ul class="menu menu-sm w-full">
        <li>
          <a href={getRelativeLocaleUrl(resolvedLang, '/')}>
            {t(resolvedLang, 'navigation.home')}
          </a>
        </li>
        {
          NAV_ITEMS.map((item) =>
            item.tags && item.tags.length > 0 ? (
              <li>
                <details>
                  <summary>{t(resolvedLang, `navigation.${item.key}`)}</summary>
                  <ul>
                    <li>
                      <a href={getRelativeLocaleUrl(resolvedLang, `/category/${item.key}`)}>
                        {t(resolvedLang, `navigation.${item.key}`)}
                      </a>
                    </li>
                    {item.tags.map((tag) => (
                      <li>
                        <a href={getRelativeLocaleUrl(resolvedLang, `/tags/${tag}`)}>
                          {t(resolvedLang, `tags.${tag}`)}
                        </a>
                      </li>
                    ))}
                  </ul>
                </details>
              </li>
            ) : (
              <li>
                <a href={getRelativeLocaleUrl(resolvedLang, `/category/${item.key}`)}>
                  {t(resolvedLang, `navigation.${item.key}`)}
                </a>
              </li>
            ),
          )
        }
      </ul>
    </div>
  </div>
</div>
