[phases.setup]
pkgs = ["nodejs_23", "npm"]

[phases.install]
# 去掉 -g，直接安装到项目本地目录更可靠，或者保留 -g 配合 npx 使用
cmds = ["npm ci", "npm install edgeone"]

[phases.build]
# 使用 npx 来调用 edgeone，这能确保即使路径没在 $PATH 里也能找到该指令
cmds = [
    "npm run build",
    "npx edgeone pages deploy ./dist -n $EDGEONE_PROJECT_NAME -t $EDGEONE_API_TOKEN --force"
]

[start]
cmd = "node deploy-wrapper.cjs"